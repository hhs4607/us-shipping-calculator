/**
 * Generate Yamato Transport rate data JSON files from PDF-extracted data.
 * Source: 03_운임일람_2025dec_API.pdf (Cash), 01_운임개정안내_2025oct.pdf (Cashless)
 * Effective: 2025-12-01 (standard rates), 2025-11-10 (intraprefectural)
 */
const fs = require('fs');
const path = require('path');

const OUT_DIR = path.join(__dirname, 'public/data/2025/yamato');

const ZONE_IDS = [
  'hokkaido', 'kita_tohoku', 'minami_tohoku', 'kanto',
  'shin_etsu', 'hokuriku', 'chubu', 'kansai',
  'chugoku', 'shikoku', 'kyushu', 'okinawa'
];

const SIZES = [60, 80, 100, 120, 140, 160, 180, 200];

// ═══════════════════════════════════════════════════════════
// CASH RATES — Source: 03_운임일람_2025dec_API.pdf (2025.12.01~)
// Each row: [hokkaido, kita_tohoku, ..., okinawa] (12 destinations)
// ═══════════════════════════════════════════════════════════
const CASH = {
  hokkaido: {
    60:  [940, 1190, 1320, 1460, 1460, 1610, 1610, 1920, 2070, 2070, 2340, 2340],
    80:  [1230, 1480, 1610, 1740, 1740, 1900, 1900, 2200, 2360, 2360, 2620, 2950],
    100: [1530, 1790, 1920, 2050, 2050, 2200, 2200, 2510, 2670, 2670, 2930, 3590],
    120: [2040, 2310, 2460, 2610, 2610, 2780, 2780, 3120, 3280, 3280, 3580, 4240],
    140: [2630, 2930, 3100, 3250, 3250, 3440, 3440, 3810, 3990, 3990, 4310, 4910],
    160: [3020, 3320, 3480, 3630, 3630, 3820, 3820, 4180, 4370, 4370, 4690, 5560],
    180: [3680, 4900, 5060, 5220, 5220, 6460, 6460, 6820, 7410, 7410, 7860, 9080],
    200: [4470, 6220, 6380, 6540, 6540, 8050, 8050, 8410, 9320, 9320, 9770, 10730]
  },
  kita_tohoku: {
    60:  [1190, 940, 940, 1060, 1060, 1190, 1190, 1320, 1460, 1460, 1760, 1920],
    80:  [1480, 1230, 1230, 1350, 1350, 1480, 1480, 1610, 1740, 1740, 2050, 2530],
    100: [1790, 1530, 1530, 1650, 1650, 1790, 1790, 1920, 2050, 2050, 2360, 3170],
    120: [2310, 2040, 2040, 2170, 2170, 2310, 2310, 2460, 2610, 2610, 2940, 3820],
    140: [2930, 2630, 2630, 2780, 2780, 2930, 2930, 3100, 3250, 3250, 3620, 4490],
    160: [3320, 3020, 3020, 3160, 3160, 3320, 3320, 3480, 3630, 3630, 4010, 5140],
    180: [4900, 3680, 3680, 4480, 4480, 4900, 4900, 5060, 5220, 5220, 6650, 8550],
    200: [6220, 4470, 4470, 5410, 5410, 6220, 6220, 6380, 6540, 6540, 8230, 10200]
  },
  minami_tohoku: {
    60:  [1320, 940, 940, 940, 940, 1060, 1060, 1190, 1460, 1460, 1760, 1760],
    80:  [1610, 1230, 1230, 1230, 1230, 1350, 1350, 1480, 1740, 1740, 2050, 2380],
    100: [1920, 1530, 1530, 1530, 1530, 1650, 1650, 1790, 2050, 2050, 2360, 3020],
    120: [2460, 2040, 2040, 2040, 2040, 2170, 2170, 2310, 2610, 2610, 2940, 3670],
    140: [3100, 2630, 2630, 2630, 2630, 2780, 2780, 2930, 3250, 3250, 3620, 4340],
    160: [3480, 3020, 3020, 3020, 3020, 3160, 3160, 3320, 3630, 3630, 4010, 4990],
    180: [5060, 3680, 3680, 3680, 3680, 4480, 4480, 4900, 5220, 5220, 6650, 8290],
    200: [6380, 4470, 4470, 4470, 4470, 5410, 5410, 6220, 6540, 6540, 8230, 9940]
  },
  kanto: {
    60:  [1460, 1060, 940, 940, 940, 940, 940, 1060, 1190, 1190, 1460, 1460],
    80:  [1740, 1350, 1230, 1230, 1230, 1230, 1230, 1350, 1480, 1480, 1740, 2070],
    100: [2050, 1650, 1530, 1530, 1530, 1530, 1530, 1650, 1790, 1790, 2050, 2710],
    120: [2610, 2170, 2040, 2040, 2040, 2040, 2040, 2170, 2310, 2310, 2610, 3360],
    140: [3250, 2780, 2630, 2630, 2630, 2630, 2630, 2780, 2930, 2930, 3250, 4030],
    160: [3630, 3160, 3020, 3020, 3020, 3020, 3020, 3160, 3320, 3320, 3630, 4680],
    180: [5220, 4480, 3680, 3680, 3680, 3680, 3680, 4480, 4900, 4900, 5220, 7210],
    200: [6540, 5410, 4470, 4470, 4470, 4470, 4470, 5410, 6220, 6220, 6540, 8860]
  },
  shin_etsu: {
    60:  [1460, 1060, 940, 940, 940, 940, 940, 1060, 1190, 1190, 1460, 1610],
    80:  [1740, 1350, 1230, 1230, 1230, 1230, 1230, 1350, 1480, 1480, 1740, 2230],
    100: [2050, 1650, 1530, 1530, 1530, 1530, 1530, 1650, 1790, 1790, 2050, 2860],
    120: [2610, 2170, 2040, 2040, 2040, 2040, 2040, 2170, 2310, 2310, 2610, 3510],
    140: [3250, 2780, 2630, 2630, 2630, 2630, 2630, 2780, 2930, 2930, 3250, 4180],
    160: [3630, 3160, 3020, 3020, 3020, 3020, 3020, 3160, 3320, 3320, 3630, 4830],
    180: [5220, 4480, 3680, 3680, 3680, 3680, 3680, 4480, 4900, 4900, 5220, 8020],
    200: [6540, 5410, 4470, 4470, 4470, 4470, 4470, 5410, 6220, 6220, 6540, 9670]
  },
  hokuriku: {
    60:  [1610, 1190, 1060, 940, 940, 940, 940, 940, 1060, 1060, 1190, 1610],
    80:  [1900, 1480, 1350, 1230, 1230, 1230, 1230, 1230, 1350, 1350, 1480, 2230],
    100: [2200, 1790, 1650, 1530, 1530, 1530, 1530, 1530, 1650, 1650, 1790, 2860],
    120: [2780, 2310, 2170, 2040, 2040, 2040, 2040, 2040, 2170, 2170, 2310, 3510],
    140: [3440, 2930, 2780, 2630, 2630, 2630, 2630, 2630, 2780, 2780, 2930, 4180],
    160: [3820, 3320, 3160, 3020, 3020, 3020, 3020, 3020, 3160, 3160, 3320, 4830],
    180: [6460, 4900, 4480, 3680, 3680, 3680, 3680, 3680, 4480, 4480, 4900, 8020],
    200: [8050, 6220, 5410, 4470, 4470, 4470, 4470, 4470, 5410, 5410, 6220, 9670]
  },
  chubu: {
    60:  [1610, 1190, 1060, 940, 940, 940, 940, 940, 1060, 1060, 1190, 1460],
    80:  [1900, 1480, 1350, 1230, 1230, 1230, 1230, 1230, 1350, 1350, 1480, 2070],
    100: [2200, 1790, 1650, 1530, 1530, 1530, 1530, 1530, 1650, 1650, 1790, 2710],
    120: [2780, 2310, 2170, 2040, 2040, 2040, 2040, 2040, 2170, 2170, 2310, 3360],
    140: [3440, 2930, 2780, 2630, 2630, 2630, 2630, 2630, 2780, 2780, 2930, 4030],
    160: [3820, 3320, 3160, 3020, 3020, 3020, 3020, 3020, 3160, 3160, 3320, 4680],
    180: [6460, 4900, 4480, 3680, 3680, 3680, 3680, 3680, 4480, 4480, 4900, 7210],
    200: [8050, 6220, 5410, 4470, 4470, 4470, 4470, 4470, 5410, 5410, 6220, 8860]
  },
  kansai: {
    60:  [1920, 1320, 1190, 1060, 1060, 940, 940, 940, 940, 940, 1060, 1460],
    80:  [2200, 1610, 1480, 1350, 1350, 1230, 1230, 1230, 1230, 1230, 1350, 2070],
    100: [2510, 1920, 1790, 1650, 1650, 1530, 1530, 1530, 1530, 1530, 1650, 2710],
    120: [3120, 2460, 2310, 2170, 2170, 2040, 2040, 2040, 2040, 2040, 2170, 3360],
    140: [3810, 3100, 2930, 2780, 2780, 2630, 2630, 2630, 2630, 2630, 2780, 4030],
    160: [4180, 3480, 3320, 3160, 3160, 3020, 3020, 3020, 3020, 3020, 3160, 4680],
    180: [6820, 5060, 4900, 4480, 4480, 3680, 3680, 3680, 3680, 3680, 4480, 7210],
    200: [8410, 6380, 6220, 5410, 5410, 4470, 4470, 4470, 4470, 4470, 5410, 8860]
  },
  chugoku: {
    60:  [2070, 1460, 1460, 1190, 1190, 1060, 1060, 940, 940, 940, 940, 1460],
    80:  [2360, 1740, 1740, 1480, 1480, 1350, 1350, 1230, 1230, 1230, 1230, 2070],
    100: [2670, 2050, 2050, 1790, 1790, 1650, 1650, 1530, 1530, 1530, 1530, 2710],
    120: [3280, 2610, 2610, 2310, 2310, 2170, 2170, 2040, 2040, 2040, 2040, 3360],
    140: [3990, 3250, 3250, 2930, 2930, 2780, 2780, 2630, 2630, 2630, 2630, 4030],
    160: [4370, 3630, 3630, 3320, 3320, 3160, 3160, 3020, 3020, 3020, 3020, 4680],
    180: [7410, 5220, 5220, 4900, 4900, 4480, 4480, 3680, 3680, 3680, 3680, 7210],
    200: [9320, 6540, 6540, 6220, 6220, 5410, 5410, 4470, 4470, 4470, 4470, 8860]
  },
  shikoku: {
    60:  [2070, 1460, 1460, 1190, 1190, 1060, 1060, 940, 940, 940, 1060, 1460],
    80:  [2360, 1740, 1740, 1480, 1480, 1350, 1350, 1230, 1230, 1230, 1350, 2070],
    100: [2670, 2050, 2050, 1790, 1790, 1650, 1650, 1530, 1530, 1530, 1650, 2710],
    120: [3280, 2610, 2610, 2310, 2310, 2170, 2170, 2040, 2040, 2040, 2170, 3360],
    140: [3990, 3250, 3250, 2930, 2930, 2780, 2780, 2630, 2630, 2630, 2780, 4030],
    160: [4370, 3630, 3630, 3320, 3320, 3160, 3160, 3020, 3020, 3020, 3160, 4680],
    180: [7410, 5220, 5220, 4900, 4900, 4480, 4480, 3680, 3680, 3680, 4480, 7210],
    200: [9320, 6540, 6540, 6220, 6220, 5410, 5410, 4470, 4470, 4470, 5410, 8860]
  },
  kyushu: {
    60:  [2340, 1760, 1760, 1460, 1460, 1190, 1190, 1060, 940, 1060, 940, 1320],
    80:  [2620, 2050, 2050, 1740, 1740, 1480, 1480, 1350, 1230, 1350, 1230, 1940],
    100: [2930, 2360, 2360, 2050, 2050, 1790, 1790, 1650, 1530, 1650, 1530, 2580],
    120: [3580, 2940, 2940, 2610, 2610, 2310, 2310, 2170, 2040, 2170, 2040, 3230],
    140: [4310, 3620, 3620, 3250, 3250, 2930, 2930, 2780, 2630, 2780, 2630, 3900],
    160: [4690, 4010, 4010, 3630, 3630, 3320, 3320, 3160, 3020, 3160, 3020, 4550],
    180: [7860, 6650, 6650, 5220, 5220, 4900, 4900, 4480, 3680, 4480, 3680, 6970],
    200: [9770, 8230, 8230, 6540, 6540, 6220, 6220, 5410, 4470, 5410, 4470, 8620]
  },
  okinawa: {
    60:  [2340, 1920, 1760, 1460, 1610, 1610, 1460, 1460, 1460, 1460, 1320, 940],
    80:  [2950, 2530, 2380, 2070, 2230, 2230, 2070, 2070, 2070, 2070, 1940, 1230],
    100: [3590, 3170, 3020, 2710, 2860, 2860, 2710, 2710, 2710, 2710, 2580, 1530],
    120: [4240, 3820, 3670, 3360, 3510, 3510, 3360, 3360, 3360, 3360, 3230, 1850],
    140: [4910, 4490, 4340, 4030, 4180, 4180, 4030, 4030, 4030, 4030, 3900, 2190],
    160: [5560, 5140, 4990, 4680, 4830, 4830, 4680, 4680, 4680, 4680, 4550, 2510],
    180: [9080, 8550, 8290, 7210, 8020, 8020, 7210, 7210, 7210, 7210, 6970, 3060],
    200: [10730, 10200, 9940, 8860, 9670, 9670, 8860, 8860, 8860, 8860, 8620, 3720]
  }
};

// ═══════════════════════════════════════════════════════════
// CASHLESS RATES — Source: 01_운임개정안내_2025oct.pdf pages 3-4
// ═══════════════════════════════════════════════════════════
const CASHLESS = {
  hokkaido: {
    60:  [935, 1188, 1320, 1452, 1452, 1606, 1606, 1914, 2068, 2068, 2332, 2332],
    80:  [1221, 1474, 1606, 1738, 1738, 1892, 1892, 2200, 2354, 2354, 2618, 2948],
    100: [1529, 1782, 1914, 2046, 2046, 2200, 2200, 2508, 2662, 2662, 2926, 3586],
    120: [2035, 2310, 2453, 2607, 2607, 2772, 2772, 3113, 3278, 3278, 3575, 4235],
    140: [2629, 2926, 3091, 3245, 3245, 3432, 3432, 3806, 3982, 3982, 4301, 4906],
    160: [3014, 3311, 3476, 3630, 3630, 3817, 3817, 4180, 4367, 4367, 4686, 5555],
    180: [3674, 4895, 5060, 5214, 5214, 6457, 6457, 6820, 7403, 7403, 7854, 9075],
    200: [4466, 6215, 6380, 6534, 6534, 8041, 8041, 8404, 9317, 9317, 9768, 10725]
  },
  kita_tohoku: {
    60:  [1188, 935, 935, 1056, 1056, 1188, 1188, 1320, 1452, 1452, 1760, 1914],
    80:  [1474, 1221, 1221, 1342, 1342, 1474, 1474, 1606, 1738, 1738, 2046, 2530],
    100: [1782, 1529, 1529, 1650, 1650, 1782, 1782, 1914, 2046, 2046, 2354, 3168],
    120: [2310, 2035, 2035, 2167, 2167, 2310, 2310, 2453, 2607, 2607, 2937, 3817],
    140: [2926, 2629, 2629, 2772, 2772, 2926, 2926, 3091, 3245, 3245, 3619, 4488],
    160: [3311, 3014, 3014, 3157, 3157, 3311, 3311, 3476, 3630, 3630, 4004, 5137],
    180: [4895, 3674, 3674, 4477, 4477, 4895, 4895, 5060, 5214, 5214, 6644, 8547],
    200: [6215, 4466, 4466, 5401, 5401, 6215, 6215, 6380, 6534, 6534, 8228, 10197]
  },
  minami_tohoku: {
    60:  [1320, 935, 935, 935, 935, 1056, 1056, 1188, 1452, 1452, 1760, 1760],
    80:  [1606, 1221, 1221, 1221, 1221, 1342, 1342, 1474, 1738, 1738, 2046, 2376],
    100: [1914, 1529, 1529, 1529, 1529, 1650, 1650, 1782, 2046, 2046, 2354, 3014],
    120: [2453, 2035, 2035, 2035, 2035, 2167, 2167, 2310, 2607, 2607, 2937, 3663],
    140: [3091, 2629, 2629, 2629, 2629, 2772, 2772, 2926, 3245, 3245, 3619, 4334],
    160: [3476, 3014, 3014, 3014, 3014, 3157, 3157, 3311, 3630, 3630, 4004, 4983],
    180: [5060, 3674, 3674, 3674, 3674, 4477, 4477, 4895, 5214, 5214, 6644, 8283],
    200: [6380, 4466, 4466, 4466, 4466, 5401, 5401, 6215, 6534, 6534, 8228, 9933]
  },
  kanto: {
    60:  [1452, 1056, 935, 935, 935, 935, 935, 1056, 1188, 1188, 1452, 1452],
    80:  [1738, 1342, 1221, 1221, 1221, 1221, 1221, 1342, 1474, 1474, 1738, 2068],
    100: [2046, 1650, 1529, 1529, 1529, 1529, 1529, 1650, 1782, 1782, 2046, 2706],
    120: [2607, 2167, 2035, 2035, 2035, 2035, 2035, 2167, 2310, 2310, 2607, 3355],
    140: [3245, 2772, 2629, 2629, 2629, 2629, 2629, 2772, 2926, 2926, 3245, 4026],
    160: [3630, 3157, 3014, 3014, 3014, 3014, 3014, 3157, 3311, 3311, 3630, 4675],
    180: [5214, 4477, 3674, 3674, 3674, 3674, 3674, 4477, 4895, 4895, 5214, 7205],
    200: [6534, 5401, 4466, 4466, 4466, 4466, 4466, 5401, 6215, 6215, 6534, 8855]
  },
  shin_etsu: {
    60:  [1452, 1056, 935, 935, 935, 935, 935, 1056, 1188, 1188, 1452, 1606],
    80:  [1738, 1342, 1221, 1221, 1221, 1221, 1221, 1342, 1474, 1474, 1738, 2222],
    100: [2046, 1650, 1529, 1529, 1529, 1529, 1529, 1650, 1782, 1782, 2046, 2860],
    120: [2607, 2167, 2035, 2035, 2035, 2035, 2035, 2167, 2310, 2310, 2607, 3509],
    140: [3245, 2772, 2629, 2629, 2629, 2629, 2629, 2772, 2926, 2926, 3245, 4180],
    160: [3630, 3157, 3014, 3014, 3014, 3014, 3014, 3157, 3311, 3311, 3630, 4829],
    180: [5214, 4477, 3674, 3674, 3674, 3674, 3674, 4477, 4895, 4895, 5214, 8019],
    200: [6534, 5401, 4466, 4466, 4466, 4466, 4466, 5401, 6215, 6215, 6534, 9669]
  },
  hokuriku: {
    60:  [1606, 1188, 1056, 935, 935, 935, 935, 935, 1056, 1056, 1188, 1606],
    80:  [1892, 1474, 1342, 1221, 1221, 1221, 1221, 1221, 1342, 1342, 1474, 2222],
    100: [2200, 1782, 1650, 1529, 1529, 1529, 1529, 1529, 1650, 1650, 1782, 2860],
    120: [2772, 2310, 2167, 2035, 2035, 2035, 2035, 2035, 2167, 2167, 2310, 3509],
    140: [3432, 2926, 2772, 2629, 2629, 2629, 2629, 2629, 2772, 2772, 2926, 4180],
    160: [3817, 3311, 3157, 3014, 3014, 3014, 3014, 3014, 3157, 3157, 3311, 4829],
    180: [6457, 4895, 4477, 3674, 3674, 3674, 3674, 3674, 4477, 4477, 4895, 8019],
    200: [8041, 6215, 5401, 4466, 4466, 4466, 4466, 4466, 5401, 5401, 6215, 9669]
  },
  chubu: {
    60:  [1606, 1188, 1056, 935, 935, 935, 935, 935, 1056, 1056, 1188, 1452],
    80:  [1892, 1474, 1342, 1221, 1221, 1221, 1221, 1221, 1342, 1342, 1474, 2068],
    100: [2200, 1782, 1650, 1529, 1529, 1529, 1529, 1529, 1650, 1650, 1782, 2706],
    120: [2772, 2310, 2167, 2035, 2035, 2035, 2035, 2035, 2167, 2167, 2310, 3355],
    140: [3432, 2926, 2772, 2629, 2629, 2629, 2629, 2629, 2772, 2772, 2926, 4026],
    160: [3817, 3311, 3157, 3014, 3014, 3014, 3014, 3014, 3157, 3157, 3311, 4675],
    180: [6457, 4895, 4477, 3674, 3674, 3674, 3674, 3674, 4477, 4477, 4895, 7205],
    200: [8041, 6215, 5401, 4466, 4466, 4466, 4466, 4466, 5401, 5401, 6215, 8855]
  },
  kansai: {
    60:  [1914, 1320, 1188, 1056, 1056, 935, 935, 935, 935, 935, 1056, 1452],
    80:  [2200, 1606, 1474, 1342, 1342, 1221, 1221, 1221, 1221, 1221, 1342, 2068],
    100: [2508, 1914, 1782, 1650, 1650, 1529, 1529, 1529, 1529, 1529, 1650, 2706],
    120: [3113, 2453, 2310, 2167, 2167, 2035, 2035, 2035, 2035, 2035, 2167, 3355],
    140: [3806, 3091, 2926, 2772, 2772, 2629, 2629, 2629, 2629, 2629, 2772, 4026],
    160: [4180, 3476, 3311, 3157, 3157, 3014, 3014, 3014, 3014, 3014, 3157, 4675],
    180: [6820, 5060, 4895, 4477, 4477, 3674, 3674, 3674, 3674, 3674, 4477, 7205],
    200: [8404, 6380, 6215, 5401, 5401, 4466, 4466, 4466, 4466, 4466, 5401, 8855]
  },
  chugoku: {
    60:  [2068, 1452, 1452, 1188, 1188, 1056, 1056, 935, 935, 935, 935, 1452],
    80:  [2354, 1738, 1738, 1474, 1474, 1342, 1342, 1221, 1221, 1221, 1221, 2068],
    100: [2662, 2046, 2046, 1782, 1782, 1650, 1650, 1529, 1529, 1529, 1529, 2706],
    120: [3278, 2607, 2607, 2310, 2310, 2167, 2167, 2035, 2035, 2035, 2035, 3355],
    140: [3982, 3245, 3245, 2926, 2926, 2772, 2772, 2629, 2629, 2629, 2629, 4026],
    160: [4367, 3630, 3630, 3311, 3311, 3157, 3157, 3014, 3014, 3014, 3014, 4675],
    180: [7403, 5214, 5214, 4895, 4895, 4477, 4477, 3674, 3674, 3674, 3674, 7205],
    200: [9317, 6534, 6534, 6215, 6215, 5401, 5401, 4466, 4466, 4466, 4466, 8855]
  },
  shikoku: {
    60:  [2068, 1452, 1452, 1188, 1188, 1056, 1056, 935, 935, 935, 1056, 1452],
    80:  [2354, 1738, 1738, 1474, 1474, 1342, 1342, 1221, 1221, 1221, 1342, 2068],
    100: [2662, 2046, 2046, 1782, 1782, 1650, 1650, 1529, 1529, 1529, 1650, 2706],
    120: [3278, 2607, 2607, 2310, 2310, 2167, 2167, 2035, 2035, 2035, 2167, 3355],
    140: [3982, 3245, 3245, 2926, 2926, 2772, 2772, 2629, 2629, 2629, 2772, 4026],
    160: [4367, 3630, 3630, 3311, 3311, 3157, 3157, 3014, 3014, 3014, 3157, 4675],
    180: [7403, 5214, 5214, 4895, 4895, 4477, 4477, 3674, 3674, 3674, 4477, 7205],
    200: [9317, 6534, 6534, 6215, 6215, 5401, 5401, 4466, 4466, 4466, 5401, 8855]
  },
  kyushu: {
    60:  [2332, 1760, 1760, 1452, 1452, 1188, 1188, 1056, 935, 1056, 935, 1320],
    80:  [2618, 2046, 2046, 1738, 1738, 1474, 1474, 1342, 1221, 1342, 1221, 1936],
    100: [2926, 2354, 2354, 2046, 2046, 1782, 1782, 1650, 1529, 1650, 1529, 2574],
    120: [3575, 2937, 2937, 2607, 2607, 2310, 2310, 2167, 2035, 2167, 2035, 3223],
    140: [4301, 3619, 3619, 3245, 3245, 2926, 2926, 2772, 2629, 2772, 2629, 3894],
    160: [4686, 4004, 4004, 3630, 3630, 3311, 3311, 3157, 3014, 3157, 3014, 4543],
    180: [7854, 6644, 6644, 5214, 5214, 4895, 4895, 4477, 3674, 4477, 3674, 6963],
    200: [9768, 8228, 8228, 6534, 6534, 6215, 6215, 5401, 4466, 5401, 4466, 8613]
  },
  okinawa: {
    60:  [2332, 1914, 1760, 1452, 1606, 1606, 1452, 1452, 1452, 1452, 1320, 935],
    80:  [2948, 2530, 2376, 2068, 2222, 2222, 2068, 2068, 2068, 2068, 1936, 1221],
    100: [3586, 3168, 3014, 2706, 2860, 2860, 2706, 2706, 2706, 2706, 2574, 1529],
    120: [4235, 3817, 3663, 3355, 3509, 3509, 3355, 3355, 3355, 3355, 3223, 1848],
    140: [4906, 4488, 4334, 4026, 4180, 4180, 4026, 4026, 4026, 4026, 3894, 2189],
    160: [5555, 5137, 4983, 4675, 4829, 4829, 4675, 4675, 4675, 4675, 4543, 2508],
    180: [9075, 8547, 8283, 7205, 8019, 8019, 7205, 7205, 7205, 7205, 6963, 3058],
    200: [10725, 10197, 9933, 8855, 9669, 9669, 8855, 8855, 8855, 8855, 8613, 3718]
  }
};

// ═══════════════════════════════════════════════════════════
// VALIDATION
// ═══════════════════════════════════════════════════════════
function validate(data, label) {
  let errors = 0;
  // Check all zones present
  for (const z of ZONE_IDS) {
    if (!data[z]) { console.error(`${label}: Missing zone ${z}`); errors++; continue; }
    for (const s of SIZES) {
      const row = data[z][s];
      if (!row) { console.error(`${label}: Missing ${z}/${s}`); errors++; continue; }
      if (row.length !== 12) { console.error(`${label}: ${z}/${s} has ${row.length} values (expected 12)`); errors++; }
    }
  }
  // Symmetry check (A→B should equal B→A for non-Okinawa)
  for (let i = 0; i < ZONE_IDS.length; i++) {
    for (let j = i + 1; j < ZONE_IDS.length; j++) {
      const a = ZONE_IDS[i], b = ZONE_IDS[j];
      for (const s of SIZES) {
        const ab = data[a][s][j];
        const ba = data[b][s][i];
        if (ab !== ba) {
          console.error(`${label}: Asymmetry ${a}→${b} size${s}=${ab} vs ${b}→${a}=${ba}`);
          errors++;
        }
      }
    }
  }
  return errors;
}

// ═══════════════════════════════════════════════════════════
// BUILD JSON OUTPUT
// ═══════════════════════════════════════════════════════════
function buildRateJson(data) {
  const result = {};
  for (const origin of ZONE_IDS) {
    result[origin] = {};
    for (const size of SIZES) {
      result[origin][size] = {};
      data[origin][size].forEach((val, idx) => {
        result[origin][size][ZONE_IDS[idx]] = val;
      });
    }
  }
  return result;
}

function writeJson(filename, data) {
  const filepath = path.join(OUT_DIR, filename);
  fs.writeFileSync(filepath, JSON.stringify(data, null, 2) + '\n');
  console.log(`  Written: ${filepath}`);
}

// ═══════════════════════════════════════════════════════════
// MAIN
// ═══════════════════════════════════════════════════════════
console.log('Validating Cash rates...');
const cashErrors = validate(CASH, 'CASH');
console.log('Validating Cashless rates...');
const cashlessErrors = validate(CASHLESS, 'CASHLESS');

if (cashErrors + cashlessErrors > 0) {
  console.error(`\nTotal errors: ${cashErrors + cashlessErrors}. Fix before generating.`);
  process.exit(1);
}
console.log('All validations passed!\n');

fs.mkdirSync(OUT_DIR, { recursive: true });

// 1. rates-cash.json
console.log('Generating rates-cash.json...');
writeJson('rates-cash.json', buildRateJson(CASH));

// 2. rates-cashless.json
console.log('Generating rates-cashless.json...');
writeJson('rates-cashless.json', buildRateJson(CASHLESS));

// 3. rates-intrapref.json (Source: 04_당일배달_보도자료_EN.pdf p4)
console.log('Generating rates-intrapref.json...');
writeJson('rates-intrapref.json', {
  effective_date: '2025-11-10',
  note: 'Intraprefectural fares — excludes Okinawa',
  cash: { 60: 790, 80: 1090, 100: 1410, 120: 1730, 140: 2090, 160: 2410, 180: 3030, 200: 3690 },
  cashless: { 60: 781, 80: 1089, 100: 1408, 120: 1727, 140: 2090, 160: 2409, 180: 3025, 200: 3685 }
});

// 4. zones.json
console.log('Generating zones.json...');
writeJson('zones.json', [
  {
    id: 'hokkaido', name_ja: '北海道', name_en: 'Hokkaido', index: 0,
    prefectures: ['北海道']
  },
  {
    id: 'kita_tohoku', name_ja: '北東北', name_en: 'Kita-Tohoku', index: 1,
    prefectures: ['青森県', '秋田県', '岩手県']
  },
  {
    id: 'minami_tohoku', name_ja: '南東北', name_en: 'Minami-Tohoku', index: 2,
    prefectures: ['宮城県', '山形県', '福島県']
  },
  {
    id: 'kanto', name_ja: '関東', name_en: 'Kanto', index: 3,
    prefectures: ['茨城県', '栃木県', '群馬県', '埼玉県', '千葉県', '神奈川県', '東京都', '山梨県']
  },
  {
    id: 'shin_etsu', name_ja: '信越', name_en: "Shin'etsu", index: 4,
    prefectures: ['新潟県', '長野県']
  },
  {
    id: 'hokuriku', name_ja: '北陸', name_en: 'Hokuriku', index: 5,
    prefectures: ['富山県', '石川県', '福井県']
  },
  {
    id: 'chubu', name_ja: '中部', name_en: 'Chubu', index: 6,
    prefectures: ['静岡県', '愛知県', '三重県', '岐阜県']
  },
  {
    id: 'kansai', name_ja: '関西', name_en: 'Kansai', index: 7,
    prefectures: ['大阪府', '京都府', '滋賀県', '奈良県', '和歌山県', '兵庫県']
  },
  {
    id: 'chugoku', name_ja: '中国', name_en: 'Chugoku', index: 8,
    prefectures: ['岡山県', '広島県', '山口県', '鳥取県', '島根県']
  },
  {
    id: 'shikoku', name_ja: '四国', name_en: 'Shikoku', index: 9,
    prefectures: ['香川県', '徳島県', '愛媛県', '高知県']
  },
  {
    id: 'kyushu', name_ja: '九州', name_en: 'Kyushu', index: 10,
    prefectures: ['福岡県', '佐賀県', '長崎県', '熊本県', '大分県', '宮崎県', '鹿児島県']
  },
  {
    id: 'okinawa', name_ja: '沖縄', name_en: 'Okinawa', index: 11,
    prefectures: ['沖縄県']
  }
]);

// 5. surcharges.json
console.log('Generating surcharges.json...');
writeJson('surcharges.json', {
  cool: {
    note: 'Chilled (0~10°C) or Frozen (-15°C). Max size 120.',
    60: 275,
    80: 330,
    100: 440,
    120: 715
  },
  same_day: {
    note: 'Same-day delivery (+550, +330 for Okinawa)',
    standard: 550,
    okinawa: 330
  },
  cod: {
    note: 'Cash on delivery fee by declared value range',
    ranges: [
      { min: 0, max: 9999, fee: 330 },
      { min: 10000, max: 29999, fee: 440 },
      { min: 30000, max: 99999, fee: 660 },
      { min: 100000, max: 300000, fee: 1100 }
    ]
  },
  anonymous: {
    note: 'Anonymous delivery',
    fee: 55
  }
});

// 6. discounts.json
console.log('Generating discounts.json...');
writeJson('discounts.json', {
  dropoff: {
    name_ja: '持込割',
    name_en: 'Drop-off discount',
    amount: -110,
    note: 'Drop off at sales office, PUDO, convenience store, or designated shop'
  },
  member_dropoff: {
    name_ja: 'クロネコメンバーズ持込割',
    name_en: 'Member drop-off discount',
    amount: -150,
    note: 'Kuroneko Members drop-off (replaces standard drop-off)'
  },
  digital: {
    name_ja: 'デジタル割',
    name_en: 'Digital label discount',
    amount: -60,
    note: 'Digital shipping label'
  },
  multi_package: {
    name_ja: '複数口割引',
    name_en: 'Multi-package discount',
    amount: -100,
    note: 'Multiple packages to same destination'
  },
  branch_pickup: {
    name_ja: '営業所受取割引',
    name_en: 'Branch pickup discount',
    amount: -60,
    note: 'Recipient picks up at sales office'
  }
});

// 7. defaults.json (MUSICUS items for Japan domestic)
console.log('Generating defaults.json...');
writeJson('defaults.json', {
  origin: 'kanto',
  destination: 'kansai',
  payment: 'cash',
  items: [
    { name: 'frame (L)', dimensions_mm: '1190*295*190', weight_kg: 57.0, qty: 1 },
    { name: 'wood (L)', dimensions_mm: '1200*1200*90', weight_kg: 30.0, qty: 4 },
    { name: 'pillarpipe (L)', dimensions_mm: '985*120*60', weight_kg: 12.0, qty: 1 },
    { name: 'pipe joint (L)', dimensions_mm: '500*250*150', weight_kg: 7.0, qty: 1 },
    { name: 'Fabric (L)', dimensions_mm: '1290*540*140', weight_kg: 30.0, qty: 4 }
  ]
});

// 8. meta.json
console.log('Generating meta.json...');
writeJson('meta.json', {
  service: 'Yamato Transport TA-Q-BIN',
  service_ja: 'ヤマト運輸 宅急便',
  country: 'JP',
  currency: 'JPY',
  year: 2025,
  effective_date: '2025-12-01',
  intrapref_effective_date: '2025-11-10',
  source_files: [
    '03_운임일람_2025dec_API.pdf (Cash rates)',
    '01_운임개정안내_2025oct.pdf (Cash + Cashless rates)',
    '04_당일배달_보도자료_EN.pdf (Intraprefectural rates, Same-day delivery)'
  ],
  data_version: '2025.12',
  size_tiers: [60, 80, 100, 120, 140, 160, 180, 200],
  size_rules: {
    applied_size: 'MAX(three_side_sum_tier, weight_tier)',
    max_three_side_sum_cm: 200,
    max_longest_side_cm: 170,
    max_weight_kg: 30,
    weight_limits: { 60: 2, 80: 5, 100: 10, 120: 15, 140: 20, 160: 25, 180: 30, 200: 30 }
  },
  notes: [
    'All rates include 10% consumption tax',
    'Size = MAX(3-side-sum tier, weight tier)',
    'Intraprefectural fares apply for same-prefecture shipments (excl. Okinawa)',
    'Cool service max size is 120',
    'Discounts can be stacked (drop-off + digital + multi-package + branch pickup)'
  ]
});

// Summary
const totalCash = ZONE_IDS.length * ZONE_IDS.length * SIZES.length;
console.log(`\nDone! Generated 8 JSON files in ${OUT_DIR}`);
console.log(`  Cash rates: ${totalCash} values`);
console.log(`  Cashless rates: ${totalCash} values`);
console.log(`  Total rate values: ${totalCash * 2}`);
